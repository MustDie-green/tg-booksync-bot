## Телеграм бот для отправки электронных книжек на читалку

Использовать бота можно тут — https://t.me/flex_booksync_bot

### Что может бот
#### Как работает через Dropbox:
0. Чтобы пользоваться этим способом, нужно зайти в Dropbox на вашей читалке Pocketbook, чтобы появилась папка `/Приложения/Dropbox PocketBook/` и чтобы читалка подхватывала файлы оттуда, — бот будет класть книжки туда.
Из-за того, что бот грузит в папку Dropbox PocketBook, этот способ работает только с читалками Pocketbook.
1. Сначала вы нажимаете /auth — бот кидает вам ссылку для авторизации в Dropbox, переходите по ней, получаете одноразовый ключ и скидываете боту.
По этому ключу бот получает доступ ТОЛЬКО НА ЗАПИСЬ — он не сможет украсть ваши файлы, даже если захочет.
Если что, отозвать доступ можно тут — https://www.dropbox.com/account/connected_apps 
(Важно — там написаны неправильные доступы. Реальные доступы бота можно увидеть по ссылке из /auth)
2. Когда бот сказал, что авторизация прошла успешно, вы можете скидывать ему книжки файлом или пересылом.

#### Как работает через почту:
0. Сначала нужно получить для своей читалки почту для синхронизации, у Pocketbook это будет почта с @pbsync.com.
Этот способ работает для любых читалок, которые умеют получать книжки на почту. И он более безопасный, тк вы не даете доступ к своему Dropbox.
2. После этого жмем /add_email и отправляем эту почту боту — бот ее сохранит.
3. Все, можно просто отправлять боту книжки файлом или пересылом сообщения.
4. Если для вашей читалки надо добавлять почты в вайтлист, то надо добавить туда lilbourbon@yandex.ru

### Как запустить такого же бота себе
1. `git clone https://github.com/MustDie-green/tg-booksync-bot`
2. Вставить все нужное в `.env.template` и переименовать его в `.env`
3. docker compose up -d (или `bash deploy` — в этом скрипте еще делается git pull, через него можно подхватывать обновления бота, но осторожно, вдруг что-то сильно изменится и перестанет работать)

### Нюансы запуска своего бота
1. В `.env` нужны токены Dropbox-приложения и логин-пароль от Яндекс почты (бот отправляет письма через Яндекс почту)
2. Dropbox-приложение создавать тут — https://www.dropbox.com/developers/apps
3. Про пароли приложений в Яндексе написано тут — https://yandex.ru/support/id/ru/authorization/app-passwords
